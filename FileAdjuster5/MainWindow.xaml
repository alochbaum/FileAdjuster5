<Window x:Class="FileAdjuster5.MainWindow"

        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:cm="clr-namespace:System.ComponentModel;assembly=System"
        xmlns:local="clr-namespace:FileAdjuster5"
        mc:Ignorable="d"
        x:Name="MainFrame"
        Title="MainWindow" Height="450" Width="880" Icon="Icon.ico">
    <Grid Margin="10,5,10,10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*" />
            <ColumnDefinition Width="3*"/>
            <ColumnDefinition Width="3*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <StackPanel Grid.Column="0" Grid.Row="0">
            <StackPanel Orientation="Horizontal" Drop="StackPanel_Drop" AllowDrop="True">
                <Label>Source File(s) [drag here or]</Label>
                <Button x:Name="btnAddFile" Click="BtnAddFile_Click" Margin="0,0,5,0">
                    <AccessText>_Add File</AccessText>
                </Button>
                <Button x:Name="btbClear" Click="BtnClear_Click" Margin="0,0,5,0">
                    <AccessText>_Clear</AccessText>
                </Button>
                <Button x:Name="btnHistory" Click="BtnHistory_Click" ToolTip="Load file(s) from previous starts." >
                    <AccessText>_&lt;</AccessText>
                </Button>
            </StackPanel>
            <ListBox x:Name="lbFileNames" />
        </StackPanel>
        <StackPanel Grid.Column="1" Grid.Row="0" Margin="0,0,0,7">
            <StackPanel Orientation="Horizontal">
                <Label>New File Name(s)</Label>
                <Button x:Name="btnStart" Click="BtnStart_Click" Margin="0,0,5,0">
                    <AccessText>_Start</AccessText>
                </Button>
                <Button x:Name="btnCancel" Click="BtnCancel_Click" IsEnabled="False" Margin="0,0,5,0">
                    <AccessText>Ca_ncel</AccessText>
                </Button>
                <Label Content="extension: "></Label>
                <TextBox x:Name="tbExt" VerticalAlignment="Center">.txt</TextBox>
            </StackPanel>
            <TextBox x:Name="tbOutFile"></TextBox>
            <StackPanel Orientation="Horizontal">
                <CheckBox x:Name="cbxCombineFiles" IsChecked="True">Combine Files</CheckBox>
            </StackPanel>
        </StackPanel>
        <StackPanel Grid.Column="2" Grid.Row="0"  Margin="0,0,0,7">
            <StackPanel Orientation="Horizontal">
                <Label>Size of output file(s) in lines</Label>
                <Button x:Name="btnOpenNotePad" Margin="5,0,0,0" IsEnabled="False" Click="btnOpenNotePad_Click">
                    <AccessText>Open in Notepad_++</AccessText>
                </Button>
            </StackPanel>
            <ComboBox x:Name="cbLines" Loaded="CbLines_Loaded" />
            <ProgressBar x:Name="pbProgress" Height="10" MinHeight="4"></ProgressBar>
        </StackPanel>
        <StackPanel Grid.Row="1" Grid.ColumnSpan="3">
            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal" Margin="0">
                <Button x:Name="btnAddRow" Margin="0,0,5,0" Click="BtnAddRow_Click">Add Row</Button>
                <Button x:Name="btnClearRows" Margin="0,0,5,0" Click="btnClearRows_Click" Content="Clear or New Action"/>
                <Button x:Name="btnDelRow" Margin="0,0,5,0" Click="btnDelRow_Click">Delete Row</Button>
                <Button x:Name="btnSwapAbove" Margin="0,0,5,0" Click="btnSwapAbove_Click">Swap with Row Above</Button>
                <Label Content="--" Margin="0,0,5,0"></Label>
                <Button x:Name="btnSavePreset" Margin="0,0,5,0" Click="BtnSavePreset_Click">Save as Preset</Button>
                <Label Content="Change Row Grid -->" Margin="0,0,5,0"></Label>
                <Button x:Name="btnLoadPreset" Margin="0,0,5,0" Click="BtnLoadPreset_Click">Load Preset</Button>
                <Button x:Name="btnActionHistory" Click="BtnActionHistory_Click" ToolTip="Load a grid actions from a previous start.">
                    <AccessText>&lt;_=</AccessText>
                </Button>
            </StackPanel>
        <DataGrid x:Name="dgActions" ItemsSource="{Binding}" ClipToBounds="True" CanUserSortColumns="False" CanUserResizeColumns="False" CanUserReorderColumns="False" CanUserResizeRows="False" IsReadOnly="True"/>
        </StackPanel>
        <RichTextBox x:Name="rtbStatus" Grid.Row="2" Grid.ColumnSpan="3" Margin="0,5,0,0" AllowDrop="False" 
                     Focusable="False" IsTabStop="False" ScrollViewer.CanContentScroll="True" 
                     VerticalScrollBarVisibility="Visible"></RichTextBox>
    </Grid>
    <Window.Resources>
        <cm:BackgroundWorker x:Key="MyWorker"
                             DoWork="MyWorker_DoWork"
                             ProgressChanged="MyWorker_ProgressChanged"
                             RunWorkerCompleted="MyWorker_Complete"
                             WorkerReportsProgress="True"
                             WorkerSupportsCancellation="True"
                             ></cm:BackgroundWorker>
    </Window.Resources>
</Window>
